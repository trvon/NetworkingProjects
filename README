This is rough code and needs to be revisited.
